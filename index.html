<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Glossary Flashcards</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="sen.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
    .body-2 {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .navbar {
      position: relative;
    }

    h1 {
      margin-top: 40px;
      color: white;
    }
    .flashcard {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
      width: 350px;
      min-height: 180px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin: 0px 30px 20px 30px;
      padding: 32px 24px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: box-shadow 0.2s, transform 0.5s cubic-bezier(.4,2,.6,1), background 0.2s;
      transform-style: preserve-3d;
    }
    
    @media screen and (max-width: 429px) {
      .flashcard {
        width: 80%;
        margin: 0px auto;
        padding: 24px 16px;
      }
      .day-buttons {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 8px;
        margin-top: 10px;
        margin-bottom: 10px;
        max-width: 700px;
        width: 100%;
        box-sizing: border-box;
        padding: 0 10px;
      }

    }
    .flashcard:hover {
      box-shadow: 0 8px 32px rgba(0,0,0,0.16);
    }
    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 3px;
      margin-bottom: 20px;
      justify-items: center;
      align-items: center;
      width: 70%;
      margin-left: auto;
      margin-right: auto;
      margin-top: 30px;
    }

    .controls > button {
      width: 100%;
      height: 100%;
    }

    .back-controls {
      justify-content: start;
    }

    .back-controls > button {
      margin-top: 30px;
      margin-left: 70px;
      font-size: 10px;
      background: #113449;
      width: 100%;
    }

    button {
      background: #2d3a4b;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 22px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background: #38b6ff;
    }
    .counter {
      color: #888;
      margin-bottom: 10px;
    }
    @media screen and (min-width: 429px) {
      .day-buttons {
        display: flex;
        gap: 8px;
        margin-top: 10px;
        margin-bottom: 10px;
        justify-content: center;
        flex-wrap: wrap;
        max-width: 400px;
      }
    }
    .day-btn {
      background: #2d3a4b;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
      position: relative;
      overflow: hidden;
    }
    .day-btn:hover {
      background: #38b6ff;
    }
    .inactive-btn {
      opacity: 0.5 !important;
      pointer-events: none !important;
    }
    @keyframes ripple-flashcard {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }
    .day-btn-ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: ripple-day-btn 0.5s linear;
      background: rgba(30,30,60,0.5);
      pointer-events: none;
      z-index: 2;
    }
    @keyframes ripple-day-btn {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }
    .flashcard.flipped {
      transform: rotateY(360deg);
      transform: rotateX(360deg);
    }

      .flashcard {
    color:black
  }

 
  @media screen and (min-width: 571px) {

    .entire-body {
        min-width: 500px;
        height: 120vh;
        position: absolute;
        z-index: -1;
        background: rgba(255, 255, 255, 0.096);
        border: 1.5px solid rgba(255,255,255,0.5);
        /* backdrop-filter: blur(12px); */
        /* -webkit-backdrop-filter: blur(12px); */
        border-radius: 18px;
        padding: 32px 24px;
        margin-top: 10px;
        margin-bottom: 40px;
      }

      .controls {
        width: 60%;
        gap: 16px;
      }
    }

    @media screen and (min-width: 850px) {
      .controls {
        width: 35%;
        gap: 20px;
      }
    }

    @media screen and (max-width: 572px) {
      .entire-body {
        height: 120vh !important; 
        min-width: 400px;
        position: absolute;
        z-index: -1;
        background: rgba(255, 255, 255, 0.096);
        border: 1.5px solid rgba(255,255,255,0.5);
        /* backdrop-filter: blur(12px); */
        /* -webkit-backdrop-filter: blur(12px); */
        border-radius: 18px;
        box-shadow: 0 8px 32px 0 rgba(31,38,135,0.12);
        padding: 32px 24px;
        margin-top: 10px;
        margin-bottom: 40px;
      }
    }

    @media screen and (max-width: 469px) {
      .entire-body {
        min-width: 365px;
        height: 110vh;
        position: absolute;
        z-index: -1;
        background: rgba(255, 255, 255, 0.096);
        border: 1.5px solid rgba(255,255,255,0.5);
        /* backdrop-filter: blur(12px); */
        /* -webkit-backdrop-filter: blur(12px); */
        border-radius: 18px;
        box-shadow: 0 8px 32px 0 rgba(31,38,135,0.12);
        padding: 32px 24px;
        margin-top: 10px;
        margin-bottom: 40px;
      }
    }

    @media screen and (max-width: 434px) {
      .entire-body {
        display: none;
      }

      .navbar {
        gap: 50px !important;
      }
    }
  </style>


</head>
<body>
  <div id="particles-js" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1;"></div>
  <!-- navbar -->
    <section class="body-2">
        <section class="entire-body"></section>
        <nav class="navbar" style="gap: 80px;">
            <a href="#" class="navbar-logo">
                <img src="./Images/Dimroid_black_and_white.png" alt="Logo"
                    class="navbar-logo-img">
                <span class="navbar-logo-text">Dimroid</span>
            </a>
            <a href="#" target="_blank" rel="noopener" class="navbar-cta">
                Let's Talk
            </a>
        </nav>


        <h1 style="text-align: center;">Glossary Flashcards</h1>
        <div style="display: flex; text-align: center; flex-direction: column; align-items: center; margin-bottom: 10px; padding:0 10px;">
          <label for="calendar" style="font-size: 1rem; color: white; margin-bottom: 4px;">Select a date to view that week's glossary flashcards:</label>
          <input type="date" id="calendar" style="padding: 6px 12px; color: black; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem;" />
          <div id="week-indicator" style="margin-top: 6px; color: #38b6ff; font-weight: bold;"></div>
        </div>
        <div class="day-buttons">
          <button class="day-btn" data-day="monday">Monday</button>
          <button class="day-btn" data-day="tuesday">Tuesday</button>
          <button class="day-btn" data-day="wednesday">Wednesday</button>
          <button class="day-btn" data-day="thursday">Thursday</button>
          <button class="day-btn" data-day="friday">Friday</button>
          <button class="day-btn" data-day="saturday">Saturday</button>
          <button class="day-btn" data-day="sunday">Sunday</button>
        </div>
        <div class="counter" id="counter"></div>
        <div style="display: flex; margin-top: 25px; justify-content: center; align-items: center; gap: 16px; margin-bottom: 4px;">
          <span id="front-label" style="font-weight: bold; color: #5a6675;">Front</span>
          <span id="back-label" style="font-weight: bold; color: #aaa;">Back</span>
        </div>
        <div class="flashcard" id="flashcard">Loading...</div>
        <div class="controls">
          <button id="prevBtn">Previous</button>
          <button id="flipBtn">Flip</button>
          <button id="nextBtn">Next</button>
          <button id="viewSentencesBtn">View Sentences</button>
        </div>
  </section>

  <section class="body-2">
    <section id="visibility-toggle" style="display: none;">
      <nav class="navbar" style="gap: 80px;">
        <a href="#" class="navbar-logo">
          <img src="./Images/Dimroid_black_and_white.png" alt="Logo" class="navbar-logo-img">
          <span class="navbar-logo-text">Dimroid</span>
        </a>
        <a href="#" target="_blank" rel="noopener" class="navbar-cta">
          Let's Talk
        </a>
      </nav>
    
    
      <h1 style="text-align: center;" id="sentences-title">Sentences for: <span id="current-word"></span></h1>
        


      <section id="sentences-section" class="sentences-container-class">
        
              <div class="controls back-controls">
                <button id="backToFlashcards">
                  <i class="fa fa-arrow-left" aria-hidden="true" style="margin-right:8px;"></i>
                  Back to Flashcards
                </button>
              </div>
            <div class="sentences-container">
              <div class="sentences-wrapper">
                <div class="sentences-track" id="sentencesTrack">
                  <div class="sentence-div active" id="sentence1">
                    <div class="sentence-number">Sentence 1</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
            
                  <div class="sentence-div" id="sentence2">
                    <div class="sentence-number">Sentence 2</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
            
                  <div class="sentence-div" id="sentence3">
                    <div class="sentence-number">Sentence 3</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
            
                  <div class="sentence-div" id="sentence4">
                    <div class="sentence-number">Sentence 4</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
            
                  <div class="sentence-div" id="sentence5">
                    <div class="sentence-number">Sentence 5</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
            
                  <div class="sentence-div" id="sentence6">
                    <div class="sentence-number">Sentence 6</div>
                    <div class="sentence-text">Loading sentence...</div>
                  </div>
                </div>
              </div>
            </div>
        </section>

      <!-- <div class="flashcard" id="flashcard">Loading...</div> -->
      <div class="controls">
        <button id="sentencePrevBtn">Previous Sentence</button>
        <button id="sentenceNextBtn">Next Sentence</button>
      </div>
    </section>
  </section>


  
  <script>
    function loadLocalCSV() {
      fetch('glossary_words_py.csv')
        .then(response => {
          if (!response.ok) throw new Error('Local CSV not found');
          return response.text();
        })
        .then(csv => {
          window.latestCSV = csv;
          parseAndLoadCSV(csv);
        })
        .catch(error => {
          flashcard.textContent = 'Failed to load local CSV: ' + error;
        });
    }
    function getCurrentMondayISO() {
      const now = new Date();
      const day = now.getDay();
      const monday = new Date(now);
      monday.setDate(now.getDate() - ((day + 6) % 7));
      return monday.toISOString().split('T')[0];
    }
    function parseAndLoadCSV(csv) {
      window.latestCSV = csv;
      allCards = parseCSV(csv);
      minWeekStart = allCards.reduce((min, c) => !min || c.week_start < min ? c.week_start : min, null);
      maxWeekStart = allCards.reduce((max, c) => !max || c.week_start > max ? c.week_start : max, null);
      const currentMonday = getCurrentMondayISO();
      const weekExists = allCards.some(c => c.week_start === currentMonday);
      const defaultWeek = weekExists ? currentMonday : minWeekStart;
      calendar.value = new Date().toISOString().split('T')[0];
      setWeek(defaultWeek);
    }
    function parseCSV(text) {
      const lines = text.trim().split(/\r?\n/);
      const headers = lines[0].split(',');
      return lines.slice(1).map(line => {
        const values = [];
        let current = '', inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          if (char === '"') inQuotes = !inQuotes;
          else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
          else current += char;
        }
        values.push(current);
        const obj = {};
        headers.forEach((h, i) => obj[h.trim()] = values[i] ? values[i].trim() : '');
        return obj;
      });
    }
    let allCards = [];
    let flashcardsByDay = {};
    let minWeekStart = null;
    let maxWeekStart = null;
    let currentDay = 'monday';
    let flashcards = [];
    let current = 0;
    let showingQuestion = true;
    const flashcard = document.getElementById('flashcard');
    const counter = document.getElementById('counter');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const flipBtn = document.getElementById('flipBtn');
    const dayBtns = document.querySelectorAll('.day-btn');
    const calendar = document.getElementById('calendar');
    const weekIndicator = document.getElementById('week-indicator');
    loadLocalCSV();
    function setWeek(weekStart) {
      const weekCards = allCards.filter(c => c.week_start === weekStart);
      const controls = [prevBtn, nextBtn, flipBtn, ...dayBtns];
      if (weekCards.length === 0) {
        controls.forEach(btn => { btn.disabled = true; btn.classList.add('inactive-btn'); });
        flashcards = [];
        weekIndicator.textContent = 'No data for this week.';
        updateFlashcard();
        return;
      } else {
        controls.forEach(btn => { btn.disabled = false; btn.classList.remove('inactive-btn'); });
      }
      flashcardsByDay = {monday:[],tuesday:[],wednesday:[],thursday:[],friday:[]};
      weekCards.forEach(c => {
        if (!flashcardsByDay[c.day]) flashcardsByDay[c.day] = [];
        flashcardsByDay[c.day].push({question: c.word, answer: c.meaning});
      });
      flashcardsByDay.saturday = [].concat(
        flashcardsByDay.monday,
        flashcardsByDay.tuesday,
        flashcardsByDay.wednesday,
        flashcardsByDay.thursday,
        flashcardsByDay.friday
      );
      flashcardsByDay.sunday = [...flashcardsByDay.saturday];
      currentDay = 'monday';
      flashcards = flashcardsByDay[currentDay];
      current = 0;
      weekIndicator.textContent = `Showing glossary flashcards for week: ${weekStart}`;
      updateFlashcard();
    }
    function updateFlashcard() {
      showingQuestion = true;
      if (!flashcards || flashcards.length === 0) {
        flashcard.textContent = 'No glossary words for this day!';
        counter.textContent = '';
        document.getElementById('front-label').style.color = '#aaa' ;
        document.getElementById('back-label').style.color = '#2d3a4b';
      } else {
        flashcard.textContent = flashcards[current].question;
        counter.textContent = `Card ${current + 1} of ${flashcards.length}`;
        document.getElementById('front-label').style.color = '#aaa' ;
        document.getElementById('back-label').style.color = '#2d3a4b';
      }
    }
    flashcard.onclick = function(e) {
      if (!flashcards || flashcards.length === 0) return;
      const rect = flashcard.getBoundingClientRect();
      const ripple = document.createElement('span');
      ripple.className = 'flashcard-ripple';
      const size = Math.max(rect.width, rect.height) * 1.2;
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = (e.clientX - rect.left - size/2) + 'px';
      ripple.style.top = (e.clientY - rect.top - size/2) + 'px';
      flashcard.appendChild(ripple);
      setTimeout(() => ripple.remove(), 500);
      showingQuestion = !showingQuestion;
      flashcard.classList.toggle('flipped', !showingQuestion);
      setTimeout(() => {
        flashcard.textContent = showingQuestion ? flashcards[current].question : flashcards[current].answer;
        document.getElementById('front-label').style.color = showingQuestion ? '#aaa' : '#2d3a4b';
        document.getElementById('back-label').style.color = showingQuestion ? '#2d3a4b' : '#aaa';
      }, 250);
    };
    flipBtn.onclick = flashcard.onclick;
    prevBtn.onclick = function() {
      if (!flashcards || flashcards.length === 0) return;
      current = (current - 1 + flashcards.length) % flashcards.length;
      updateFlashcard();
    };
    nextBtn.onclick = function() {
      if (!flashcards || flashcards.length === 0) return;
      current = (current + 1) % flashcards.length;
      updateFlashcard();
    };
    dayBtns.forEach(btn => {
      btn.onclick = function(e) {
        const rect = btn.getBoundingClientRect();
        const ripple = document.createElement('span');
        ripple.className = 'day-btn-ripple';
        const size = Math.max(rect.width, rect.height) * 1.2;
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = (e.clientX - rect.left - size/2) + 'px';
        ripple.style.top = (e.clientY - rect.top - size/2) + 'px';
        btn.appendChild(ripple);
        setTimeout(() => ripple.remove(), 500);
        currentDay = btn.getAttribute('data-day');
        flashcards = flashcardsByDay[currentDay] || [];
        current = 0;
        const weekStartMatch = weekIndicator.textContent.match(/week: (\d{4}-\d{2}-\d{2})/);
        if (weekStartMatch) {
          const weekStartStr = weekStartMatch[1];
          const weekStartDate = new Date(weekStartStr);
          const dayOffsets = {monday:0, tuesday:1, wednesday:2, thursday:3, friday:4, saturday:5, sunday:6};
          const offset = dayOffsets[currentDay] || 0;
          const newDate = new Date(weekStartDate);
          newDate.setDate(weekStartDate.getDate() + offset);
          calendar.value = newDate.toISOString().split('T')[0];
        }
        updateFlashcard();
      };
    });
    calendar.addEventListener('change', function() {
      const selectedDate = calendar.value;
      if (!selectedDate) return;
      const d = new Date(selectedDate);
      const day = d.getDay();
      const monday = new Date(d);
      monday.setDate(d.getDate() - ((day + 6) % 7));
      const weekStartStr = monday.toISOString().split('T')[0];
      if (weekStartStr < minWeekStart) {
        weekIndicator.textContent = `No data for this week. Earliest available: ${minWeekStart}`;
        flashcard.textContent = 'Cannot backdate that far!';
        counter.textContent = '';
        flashcards = [];
        disableAllControls();
        return;
      }
      if (weekStartStr > maxWeekStart) {
        weekIndicator.textContent = `No data for this week. Latest available: ${maxWeekStart}`;
        flashcard.textContent = 'This day is in the future. No words yet!';
        counter.textContent = '';
        flashcards = [];
        disableAllControls();
        return;
      }
      setWeek(weekStartStr);
    });
    function disableAllControls() {
      const controls = [prevBtn, nextBtn, flipBtn, ...dayBtns];
      controls.forEach(btn => { btn.disabled = true; btn.classList.add('inactive-btn'); });
    }
    function enableAllControls() {
      const controls = [prevBtn, nextBtn, flipBtn, ...dayBtns];
      controls.forEach(btn => { btn.disabled = false; btn.classList.remove('inactive-btn'); });
    }
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      particlesJS('particles-js', {
          "particles": {
          "number": { "value": 60, "density": { "enable": true, "value_area": 800 } },
          "color": { "value": "#fff" },
          "shape": { "type": "circle" },
          "opacity": { "value": 0.5, "random": true },
          "size": { "value": 3, "random": true },
          "line_linked": { "enable": false },
          "move": { "enable": true, "speed": 7, "direction": "none", "random": true, "straight": false, "out_mode": "out" }
          },
          "interactivity": {
          "detect_on": "canvas",
          "events": {
              "onhover": { "enable": true, "mode": "repulse" },
              "onclick": { "enable": true, "mode": "push" }
          },
          "modes": {
              "repulse": { "distance": 80, "duration": 0.4 },
              "push": { "particles_nb": 4 }
          }
          },
          "retina_detect": true
      });
    });
  </script>
  
   <script>
    // Sentences functionality variables
    const viewSentencesBtn = document.getElementById('viewSentencesBtn');
    const backToFlashcardsBtn = document.getElementById('backToFlashcards');
        const sentencesSection = document.getElementById('visibility-toggle');
    const flashcardsSection = document.querySelector('.body-2');
    const currentWordSpan = document.getElementById('current-word');
    
    // Sentence carousel variables
    let currentSentenceIndex = 0;
    const totalSentences = 6;
    const sentencesTrack = document.getElementById('sentencesTrack');
    const sentenceDivs = document.querySelectorAll('.sentence-div');
    const sentencePrevBtn = document.getElementById('sentencePrevBtn');
    const sentenceNextBtn = document.getElementById('sentenceNextBtn');
    let sentencesData = [];
    let currentWordIndex = 0;
    let totalWords = 0;
    let savedFlashcardState = { current: 0, day: 'monday' }; // To save flashcard state

    // Load the sentences CSV
    function loadSentencesCSV() {
      fetch('glossary_words_sentence_usage.csv')
        .then(response => {
          if (!response.ok) throw new Error('Sentences CSV not found');
          return response.text();
        })
        .then(csv => {
          sentencesData = parseSentencesCSV(csv);
          totalWords = sentencesData.length;
          console.log(`Loaded ${totalWords} words from sentences CSV`);
        })
        .catch(error => {
          console.error('Failed to load sentences CSV:', error);
        });
    }

    // Parse sentences CSV
    function parseSentencesCSV(text) {
      const lines = text.trim().split(/\r?\n/);
      const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
      const data = [];

      for (let i = 1; i < lines.length; i++) {
        const values = [];
        let current = '';
        let inQuotes = false;
        
        for (let j = 0; j < lines[i].length; j++) {
          const char = lines[i][j];
          if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            values.push(current.trim().replace(/^"|"$/g, ''));
            current = '';
          } else {
            current += char;
          }
        }
        values.push(current.trim().replace(/^"|"$/g, ''));

        if (values.length >= headers.length && values[0]) {
          const rowData = {};
          headers.forEach((header, index) => {
            rowData[header] = values[index] || '';
          });
          data.push(rowData);
        }
      }
      return data;
    }

    // Function to find sentences for a word
    function getSentencesForWord(word) {
      const wordData = sentencesData.find(item => 
        item.word && item.word.toLowerCase() === word.toLowerCase()
      );
      
      if (wordData) {
        return [
          wordData['Sentence 1'] || 'No sentence available',
          wordData['Sentence 2'] || 'No sentence available',
          wordData['Sentence 3'] || 'No sentence available',
          wordData['Sentence 4'] || 'No sentence available',
          wordData['Sentence 5'] || 'No sentence available',
          wordData['Sentence 6'] || 'No sentence available'
        ];
      }
      return Array(6).fill('No sentences found for this word');
    }

    // Function to update sentence carousel
    function updateSentenceCarousel() {
      let slideWidth = 400;
      if (window.innerWidth <= 400) {
        slideWidth = 300;
      } else if (window.innerWidth <= 500) {
        slideWidth = 350;
      }
      
      const translateX = -currentSentenceIndex * slideWidth;
      sentencesTrack.style.transform = `translateX(${translateX}px)`;
      
      sentenceDivs.forEach((div, index) => {
        if (index === currentSentenceIndex) {
          div.classList.add('active');
        } else {
          div.classList.remove('active');
        }
      });
    }

    // Function to navigate to the next sentence
    function navigateToNextSentence() {
      currentSentenceIndex = (currentSentenceIndex + 1) % totalSentences;
      updateSentenceCarousel();
    }

    // Function to navigate to the previous sentence
    function navigateToPreviousSentence() {
      currentSentenceIndex = (currentSentenceIndex - 1 + totalSentences) % totalSentences;
      updateSentenceCarousel();
    }

    // Function to find word index in sentences data
    function findWordIndexInSentences(word) {
      return sentencesData.findIndex(item => 
        item.word && item.word.toLowerCase() === word.toLowerCase()
      );
    }

    // Update the display for the current word in sentences
    function updateWordDisplay() {
      if (sentencesData.length === 0 || currentWordIndex >= sentencesData.length) return;
      
      const currentWord = sentencesData[currentWordIndex];
      currentWordSpan.textContent = currentWord.word || 'Unknown';
      
      // Update sentences
      for (let i = 1; i <= 6; i++) {
        const sentenceDiv = document.getElementById(`sentence${i}`);
        const sentenceText = sentenceDiv.querySelector('.sentence-text');
        const sentence = currentWord[`Sentence ${i}`] || `No sentence ${i} available`;
        sentenceText.textContent = sentence;
      }
      
      // Reset to first sentence
      currentSentenceIndex = 0;
      updateSentenceCarousel();
    }

    // Function to show sentences section
    function showSentencesSection(word) {
      // Save current flashcard state
      savedFlashcardState = {
        current: current,
        day: currentDay
      };

      // Find the word in sentences data
      currentWordIndex = findWordIndexInSentences(word);
      
      if (currentWordIndex === -1) {
        alert(`Sentences not found for "${word}"`);
        return;
      }

      updateWordDisplay();
      
      // Hide flashcards, show sentences
      flashcardsSection.style.display = 'none';
      sentencesSection.style.display = 'block';
    }

    // Function to show flashcards section
    function showFlashcardsSection() {
      sentencesSection.style.display = 'none';
      flashcardsSection.style.display = 'flex';
      
      // Restore flashcard state
      current = savedFlashcardState.current;
      currentDay = savedFlashcardState.day;
      flashcards = flashcardsByDay[currentDay] || [];
      updateFlashcard();
    }

    // Event listeners
    viewSentencesBtn.addEventListener('click', function() {
      if (!flashcards || flashcards.length === 0) {
        alert('No flashcard selected');
        return;
      }
      const currentWord = flashcards[current].question;
      showSentencesSection(currentWord);
    });

    backToFlashcardsBtn.addEventListener('click', showFlashcardsSection);

    sentenceNextBtn.addEventListener('click', navigateToNextSentence);
    sentencePrevBtn.addEventListener('click', navigateToPreviousSentence);

    // Keyboard navigation for sentences
    document.addEventListener('keydown', (e) => {
      if (sentencesSection.style.display === 'block') {
        if (e.key === 'ArrowRight') {
          navigateToNextSentence();
        } else if (e.key === 'ArrowLeft') {
          navigateToPreviousSentence();
        } else if (e.key === 'Escape') {
          showFlashcardsSection();
        }
      }
    });

    // Handle window resize for sentences
    window.addEventListener('resize', updateSentenceCarousel);

    // Touch swipe functionality for sentences
    let touchStartX = 0;
    let touchEndX = 0;
    let touchStartY = 0;
    let touchEndY = 0;
    const minSwipeDistance = 50; // Minimum distance for a swipe to register

    function handleTouchStart(e) {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }

    function handleTouchMove(e) {
      // Prevent default scrolling during horizontal swipes
      const touchCurrentX = e.touches[0].clientX;
      const touchCurrentY = e.touches[0].clientY;
      const deltaX = Math.abs(touchCurrentX - touchStartX);
      const deltaY = Math.abs(touchCurrentY - touchStartY);
      
      // If horizontal movement is greater than vertical, prevent default scrolling
      if (deltaX > deltaY) {
        e.preventDefault();
      }
    }

    function handleTouchEnd(e) {
      touchEndX = e.changedTouches[0].clientX;
      touchEndY = e.changedTouches[0].clientY;
      handleSwipe();
    }

    function handleSwipe() {
      const deltaX = touchEndX - touchStartX;
      const deltaY = touchEndY - touchStartY;
      const absDeltaX = Math.abs(deltaX);
      const absDeltaY = Math.abs(deltaY);

      // Check if it's a horizontal swipe (horizontal movement > vertical movement)
      if (absDeltaX > absDeltaY && absDeltaX > minSwipeDistance) {
        if (deltaX > 0) {
          // Swipe right - go to previous sentence
          navigateToPreviousSentence();
        } else {
          // Swipe left - go to next sentence
          navigateToNextSentence();
        }
      }
    }

    // Add touch event listeners to the sentences wrapper
    document.addEventListener('DOMContentLoaded', function() {
      const sentencesWrapper = document.querySelector('.sentences-wrapper');
      if (sentencesWrapper) {
        sentencesWrapper.addEventListener('touchstart', handleTouchStart, { passive: false });
        sentencesWrapper.addEventListener('touchmove', handleTouchMove, { passive: false });
        sentencesWrapper.addEventListener('touchend', handleTouchEnd, { passive: true });
      }
    });

    // Load sentences CSV on page load
    loadSentencesCSV();

    // Update the controls disable/enable functions to include viewSentencesBtn
    function disableAllControls() {
      const controls = [prevBtn, nextBtn, flipBtn, viewSentencesBtn, ...dayBtns];
      controls.forEach(btn => { btn.disabled = true; btn.classList.add('inactive-btn'); });
    }

    function enableAllControls() {
      const controls = [prevBtn, nextBtn, flipBtn, viewSentencesBtn, ...dayBtns];
      controls.forEach(btn => { btn.disabled = false; btn.classList.remove('inactive-btn'); });
    }
  </script>

  <script>
    // Your existing JavaScript code continues here...
    function loadLocalCSV() {
      // ... existing code ...
    }
    // ... rest of your existing JavaScript ...
  </script>
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
</body>
</html>